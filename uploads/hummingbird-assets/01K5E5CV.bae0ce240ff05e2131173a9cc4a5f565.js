/**handles:daves-wordpress-live-search**/
var LiveSearch={searchBoxes:"",activeRequests:[],callbacks:[],addCallback:function(e,s){return void 0===this.callbacks[e]&&(this.callbacks[e]=[]),this.callbacks[e].push(s)},invokeCallbacks:function(e,s){var r;if(void 0!==this.callbacks[e])for(r in this.callbacks[e])s=this.callbacks[e][r](s)}};LiveSearch.init=function(){LiveSearch.searchBoxes=jQuery("input").filter("[name='s']").not(".no-livesearch"),LiveSearch.searchBoxes.keyup(LiveSearch.handleKeypress),LiveSearch.searchBoxes.focus(LiveSearch.hideResults),LiveSearch.searchBoxes.outerHeight||alert(DavesWordPressLiveSearchConfig.outdatedJQuery),LiveSearch.searchBoxes.parents("form").attr("autocomplete","off"),LiveSearch.searchBoxes.each(function(){this.autocomplete="off"}),jQuery("html").click(LiveSearch.hideResults),LiveSearch.searchBoxes.click(function(e){e.stopPropagation()}),LiveSearch.compiledResultTemplate=_.template(DavesWordPressLiveSearchConfig.resultTemplate),jQuery(window).resize(function(){LiveSearch.positionResults(this)})},LiveSearch.positionResults=function(){var e,s=jQuery("input:focus").first(),r=jQuery("#dwls_search_results");if(r&&s.length>0){var a=s.offset(),t=s.closest(".style-light").length?"style-light":"style-dark",i=s.closest(".style-light").length?"style-light-bg":"style-dark-bg";r.addClass(i),r.wrap("<div id='uncode-search-result' class='"+t+"'></div>"),a.left+=parseInt(DavesWordPressLiveSearchConfig.xOffset,10),a.top+=s.outerHeight(!1)+parseInt(DavesWordPressLiveSearchConfig.yOffset,10),a.top-=parseInt(jQuery("html").css("margin-top"),10),a.top-=parseInt(jQuery("html").css("padding-top"),10),r.css("left",a.left),r.css("top",a.top),r.css("width",jQuery(".search-container-inner").width()),r.css("display","block"),r.css("top",e+"px")}},LiveSearch.handleAJAXResults=function(e){var s="";if(LiveSearch.activeRequests.pop(),e){if(resultsSearchTerm=e.searchTerms,resultsSearchTerm!=jQuery("input:focus").first().val())return void(0===LiveSearch.activeRequests.length&&LiveSearch.removeIndicator());var r=jQuery("#dwls_search_results").children("input[name=query]").val();if(""!==r&&resultsSearchTerm==r)return void(0===LiveSearch.activeRequests.length&&LiveSearch.removeIndicator());if(0===e.results.length)LiveSearch.hideResults();else{s=LiveSearch.compiledResultTemplate({searchResults:e.results,e:e,resultsSearchTerm:resultsSearchTerm});var a=jQuery("#dwls_search_results");a.length>0?jQuery("#dwls_search_results").replaceWith(s):jQuery("body").append(s),LiveSearch.positionResults(),jQuery("#dwls_search_results").bind("click.dwls",function(){window.location.href=jQuery(this).find("a.daves-wordpress-live-search_title").attr("href")})}0===LiveSearch.activeRequests.length&&LiveSearch.removeIndicator()}},LiveSearch.handleKeypress=function(e){var s=0,r=LiveSearch.searchBoxes.val();setTimeout(function(){LiveSearch.runQuery(r)},s)},LiveSearch.runQuery=function(e){var s=jQuery("input:focus"),r=s.val(),a,t;if(void 0!=r&&(""===r||r.length<DavesWordPressLiveSearchConfig.minCharsToSearch))LiveSearch.hideResults(),LiveSearch.removeIndicator();else{for(LiveSearch.displayIndicator();LiveSearch.activeRequests.length>0;)t=LiveSearch.activeRequests.pop(),t.abort();var i={},c=s.parents("form").find("input:not(:submit),select,textarea");for(a in c)if(c.hasOwnProperty(a)&&a%1===0){var l=jQuery(c[a]);i[l.attr("name")]=l.val()}i.action="dwls_search",t=jQuery.get(DavesWordPressLiveSearchConfig.ajaxURL,i,LiveSearch.handleAJAXResults,"json"),t.fail=LiveSearch.ajaxFailHandler,LiveSearch.activeRequests.push(t)}},LiveSearch.ajaxFailHandler=function(e){console.log("Dave's WordPress Live Search: There was an error retrieving or parsing search results"),console.log("The data returned was:"),console.log(e)},LiveSearch.hideResults=function(){var e=jQuery("#uncode-search-result");if(e.length>0)switch(LiveSearch.invokeCallbacks("BeforeHideResults"),DavesWordPressLiveSearchConfig.resultsDirection){case"up":e.fadeOut("normal",function(){e.remove(),LiveSearch.invokeCallbacks("AfterHideResults")});break;case"down":e.slideUp("normal",function(){e.remove(),LiveSearch.invokeCallbacks("AfterHideResults")});break;default:e.slideUp("normal",function(){e.remove(),LiveSearch.invokeCallbacks("AfterHideResults")})}},LiveSearch.displayIndicator=function(){if(0===jQuery(".search_results_activity_indicator").length){var e=jQuery(".uncode-live-search input"),s=e.offset();if(jQuery(".uncode-live-search i").css("opacity",0),void 0!=s){var r=e.closest(".style-light").length?"style-light":"style-dark";jQuery("body").append('<span id="search_results_activity_indicator" class="search_results_activity_indicator '+r+'" />'),jQuery(".search_results_activity_indicator").css("position","absolute").css("z-index",9999);var a=parseInt(jQuery("html").css("margin-top"),10);a+=parseInt(jQuery("html").css("padding-top"),10);var t=s.top+(e.outerHeight()-e.innerHeight())/2+12-a+"px";jQuery(".search_results_activity_indicator").css("top",t);var i=s.left+e.outerWidth()-jQuery(".search_results_activity_indicator").width()-20+"px";jQuery(".search_results_activity_indicator").css("left",i)}}},LiveSearch.removeIndicator=function(){jQuery(".uncode-live-search i").css("opacity",1),jQuery(".search_results_activity_indicator").remove()},jQuery(function(){LiveSearch.init()});